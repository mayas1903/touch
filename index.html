<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Touch Me Softly</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
        Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
      background: #fff0f6;
      margin: 0;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      overflow: hidden;
    }

    .counter {
      font-size: 18px;
      padding: 12px 20px;
      background: #ffe6f0;
      border-radius: 16px;
      box-shadow: 0 6px 15px rgba(255, 182, 193, 0.6);
      color: #d6336c;
      cursor: pointer;
      user-select: none;
      transition: background 0.3s ease;
      z-index: 10;
      position: relative;
    }

    .counter:hover {
      background: #ffccdd;
    }

    .modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #fff;
      border-radius: 20px;
      width: 270px;
      max-width: 90vw;
      padding: 18px 20px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      font-size: 15px;
      color: #000;
      text-align: center;
      user-select: none;
      box-sizing: border-box;
      word-wrap: break-word;
      z-index: 1000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.25s ease-in-out;
    }

    .modal.show {
      opacity: 1;
      pointer-events: auto;
    }

    .modal button {
      margin-top: 15px;
      background: #d6336c;
      border: none;
      color: white;
      padding: 10px 20px;
      border-radius: 12px;
      font-size: 15px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .modal button:hover {
      background: #b02753;
    }

    #confetti-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      pointer-events: none;
      z-index: 2000;
    }
  </style>
</head>
<body>

  <div class="counter" id="counter">–¢—ã: 0 | –î—Ä—É–≥: 0</div>

  <!-- –ú–æ–¥–∞–ª–∫–∞ –ø–æ–¥–∞—Ä–∫–∞ 1000 –∫–∞—Å–∞–Ω–∏–π -->
  <div id="giftModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-describedby="modalDesc">
    <h2 id="modalTitle">üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h2>
    <p id="modalDesc">–í—ã —Å–æ–±—Ä–∞–ª–∏ <strong>1000 –∫–∞—Å–∞–Ω–∏–π üíñ</strong></p>
    <p>üéÅ –ü–æ–¥–∞—Ä–æ–∫: Telegram Premium –Ω–∞ 3 –º–µ—Å—è—Ü–∞</p>
    <button id="closeGiftBtn">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>

  <!-- –ú–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω–∞—è –º–æ–¥–∞–ª–∫–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–π —Å–æ—Ç–Ω–µ -->
  <div id="motivationModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="motivationTitle" aria-describedby="motivationDesc">
    <h3 id="motivationTitle">‚ú® –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!</h3>
    <p id="motivationDesc">–í–∞–º –æ—Å—Ç–∞–ª–æ—Å—å –Ω–∞–∫–æ–ø–∏—Ç—å <span id="leftCount"></span> –∫–∞—Å–∞–Ω–∏–π</p>
    <button id="closeMotivationBtn">–û–∫</button>
  </div>

  <canvas id="confetti-canvas"></canvas>

  <script>
    const counter = document.getElementById('counter');
    const giftModal = document.getElementById('giftModal');
    const motivationModal = document.getElementById('motivationModal');
    const leftCountSpan = document.getElementById('leftCount');
    const closeGiftBtn = document.getElementById('closeGiftBtn');
    const closeMotivationBtn = document.getElementById('closeMotivationBtn');
    const confettiCanvas = document.getElementById('confetti-canvas');
    const ctx = confettiCanvas.getContext('2d');

    let myTouches = 0;
    let friendTouches = 0; // –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –ø–æ–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º
    let totalTouches = 0;

    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä canvas —Ä–∞–≤–Ω—ã–º –æ–∫–Ω—É
    function resizeCanvas() {
      confettiCanvas.width = window.innerWidth;
      confettiCanvas.height = window.innerHeight;
    }
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    // –ö–æ–Ω—Ñ–µ—Ç—Ç–∏ –∞–Ω–∏–º–∞—Ü–∏—è
    class ConfettiParticle {
      constructor() {
        this.x = Math.random() * confettiCanvas.width;
        this.y = Math.random() * confettiCanvas.height - confettiCanvas.height;
        this.size = (Math.random() * 6) + 4;
        this.speed = (Math.random() * 3) + 2;
        this.angle = Math.random() * 2 * Math.PI;
        this.spin = (Math.random() * 0.1) + 0.01;
        this.color = `hsl(${Math.floor(Math.random() * 360)}, 70%, 60%)`;
        this.opacity = 1;
      }
      update() {
        this.y += this.speed;
        this.x += Math.sin(this.angle) * 2;
        this.angle += this.spin;
        if (this.y > confettiCanvas.height) {
          this.y = -10;
          this.x = Math.random() * confettiCanvas.width;
        }
      }
      draw() {
        ctx.fillStyle = this.color;
        ctx.beginPath();
        ctx.ellipse(this.x, this.y, this.size * 0.6, this.size, this.angle, 0, 2 * Math.PI);
        ctx.fill();
      }
    }

    let confettiParticles = [];

    function startConfetti() {
      confettiParticles = [];
      for (let i = 0; i < 150; i++) {
        confettiParticles.push(new ConfettiParticle());
      }
      confettiCanvas.style.display = 'block';
      animateConfetti();
      setTimeout(stopConfetti, 4000);
    }

    function animateConfetti() {
      ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
      confettiParticles.forEach(p => {
        p.update();
        p.draw();
      });
      if (confettiParticles.length > 0) {
        requestAnimationFrame(animateConfetti);
      }
    }

    function stopConfetti() {
      confettiParticles = [];
      confettiCanvas.style.display = 'none';
      ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
    }

    // –û—Ç–∫—Ä—ã—Ç—å –∏ –∑–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª–∫–∏
    function openGiftModal() {
      giftModal.classList.add('show');
      startConfetti();
    }

    function closeGiftModal() {
      giftModal.classList.remove('show');
      stopConfetti();
    }

    function openMotivationModal(remaining) {
      leftCountSpan.textContent = remaining;
      motivationModal.classList.add('show');
      startConfetti();
    }

    function closeMotivationModal() {
      motivationModal.classList.remove('show');
      stopConfetti();
    }

    closeGiftBtn.addEventListener('click', closeGiftModal);
    closeMotivationBtn.addEventListener('click', closeMotivationModal);

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–æ–∫ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –æ–∫–Ω–∞
    window.addEventListener('click', (e) => {
      if (e.target === giftModal) closeGiftModal();
      if (e.target === motivationModal) closeMotivationModal();
    });

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ ESC
    window.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        if (giftModal.classList.contains('show')) closeGiftModal();
        if (motivationModal.classList.contains('show')) closeMotivationModal();
      }
    });

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤ –ø–æ —Å—á–µ—Ç—á–∏–∫—É
    counter.addEventListener('click', () => {
      openMotivationModal(1000 - totalTouches);
    });

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞—Å–∞–Ω–∏–π –ø–æ –≤—Å–µ–º—É —ç–∫—Ä–∞–Ω—É
    window.addEventListener('click', () => {
      myTouches++;
      totalTouches = myTouches + friendTouches;

      counter.textContent = `–¢—ã: ${myTouches} | –î—Ä—É–≥: ${friendTouches}`;

      // –ö–∞–∂–¥—ã–µ 100 –∫–∞—Å–∞–Ω–∏–π (–∫—Ä–æ–º–µ 1000)
      if (totalTouches > 0 && totalTouches % 100 === 0 && totalTouches < 1000) {
        openMotivationModal(1000 - totalTouches);
      }

      // –ü—Ä–∏ 1000 –∫–∞—Å–∞–Ω–∏–π
      if (totalTouches >= 1000) {
        openGiftModal();
      }
    });

  </script>

</body>
</html>
